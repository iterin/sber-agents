## Итерация 3

- Цель: интегрировать VisionCore в более согласованный цикл, добавить зачатки маршрутизации команд и тестов старта.
- План действий:
- 1) Реализовать базовую обвязку Iteration 3 в `src/vision_iteration3.py`.
- 2) Расширить `src/handlers.py` для поддержки реальных маршрутов (пример-словарь).  
- 3) Добавить минимальные тесты старта Iteration 3.
- 4) Обновить `docs/tasklist.md` с планом Iteration 3.
# Техническое видение проекта

Данный документ служит отправной точкой для реализации идеи из `docs/idea.md`. Мы придерживаемся подходов KISS и YAGNI.

## Технологии
- Python
- uv для управления зависимостями
- openai клиент через провайдера Openrouter
- make для сборки проекта
- aiogram для Telegram Bot API (Polling)

## Принципы разработки
- Простота и минимальная функциональность (KISS, YAGNI)
- Прозрачные интерфейсы
- Поэтапная реализация MVP

## Структура проекта
- `src/` — основной код
- `configs/` — конфигурации
- `docs/` — документация
- `Makefile` — сборка и задачи

## Архитектура проекта
- Телеграм-бот на aiogram, polling
- Модуль LLM-интерфейса: системный промпт, история диалога
- Конфигурация и логирование
- Простая память контекста

## Модель данных
- ConversationContext: история диалога
- UserProfile: настройки пользователя
- ExpenseRecord: запись расхода (минимальная)
- SystemPrompts: набор системных промптов

## Работа с LLM
- Применение системного промпта и истории диалога
- OpenRouter через Python OpenAI клиент
- Обработка лимитов и ошибок

## Сценарии работы
- Приветствие и инициализация диалога
- Запрос расходов и баланса
- Добавление расхода и обновление контекста
- Подсказки и обработка ошибок

## Подход к конфигурированию
- YAML-конфиги в `configs/`
- ENV-переменные для секретов
- Значения по умолчанию для минимальной версии

## Подход к логгированию
- Python logging с ротацией файлов
- Уровни INFO/WARNING/ERROR
- Блоки логирования для LLM и Telegram Bot

## Минимальный MVP
- Бот на aiogram с polling
- Базовый поток диалога через LLM
- Простая память диалога
- Минимальная конфигурация без сложной БД

## Риски и ограничения
- Лимиты OpenRouter/OpenAI
- Безопасность и приватность
- Ограничения Telegram API и инфраструктуры

## Следующие шаги
- Уточнить параметры конфигурации и промптов
- Развернуть MVP локально для тестирования
